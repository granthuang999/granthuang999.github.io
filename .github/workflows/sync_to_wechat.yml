# GitHub Action: Sync new articles from GitHub Issues to WeChat Official Account (Corrected Version)

name: Sync to WeChat Official Account

# 触发条件：当一个 Issue 被打上标签时触发
on:
  issues:
    types: [labeled]

jobs:
  sync:
    # 只有当被打上的标签是 "Publish" 时，才执行任务
    if: github.event.label.name == 'Publish'
    runs-on: ubuntu-latest
    steps:
      - name: Sync to WeChat Official Account MP
        # 使用一个经过验证的、可靠的替代 Action
        uses: chino-lu/wechat-mp-sync-action@main
        with:
          # 注意：这里的参数名根据新的 Action 要求有所变化 (appId -> app_id)
          app_id: ${{ secrets.WECHAT_APPID }}
          app_secret: ${{ secrets.WECHAT_APPSECRET }}
          issue_number: ${{ github.event.issue.number }}
          github_token: ${{ secrets.GITHUB_TOKEN }}
