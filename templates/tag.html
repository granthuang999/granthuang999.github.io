{% extends 'base.html' %}

{% block head %}
<meta name="description" content="{{ blogBase['title'] }} 所有文章标签与搜索">
<title>{{ blogBase['title'] }} - 标签与搜索-未来传媒-专注中年人</title>
<link href="{{ blogBase.homeUrl }}/pagefind/pagefind-ui.css" rel="stylesheet">
{% endblock %}

{% block style %}
<style>
/* [样式已清理] 从 .tagTitle 中删除了 font-size:40px; */
.tagTitle{margin:auto 0;font-weight:bold;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}

#search {
    margin-bottom: 2.5rem;
}

.tag-cloud-container {
    padding-top: 1.5rem;
    border-top: 1px solid var(--borderColor-default, var(--color-border-default));
}
.tag-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
    padding: 2rem 0;
}
.tag-link {
    display: inline-block;
    padding: 8px 18px;
    border-radius: 20px;
    color: white !important;
    text-decoration: none;
    font-size: 14px;
    font-weight: bold;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.tag-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

@media (max-width: 600px) {
    body { padding: 8px;}
    .tagTitle{display:none;}
}
</style>
{% endblock %}

{% block header %}
<h1 class="tagTitle">标签与搜索-未来传媒-专注中年人</h1>
<div class="title-right">
    <a href="{{ blogBase['homeUrl'] }}" id="buttonHome" class="btn btn-invisible circle" title="{{ i18n['home'] }}">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    <a class="btn btn-invisible circle" onclick="modeSwitch()" title="{{ i18n['switchTheme'] }}" {%- if blogBase['themeMode']=='fix' -%}style="display:none;"{%- endif -%}>
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>
</div>
{% endblock %}

{% block content %}
<div id="search"></div>

<div class="tag-cloud-container">
    <h2 style="text-align:center;">按标签浏览</h2>
    <div class="tag-cloud">
        {% for tag, info in tag_info.items() %}
            <a href="{{ info.url }}" class="tag-link" style="background-color:{{ blogBase.labelColorDict.get(tag, '#808080') }}; font-size: {{ 12 + (info.count|float / blogBase.maxTagsCount|float * 12)|round }}px;">
                {{ tag }} ({{ info.count }})
            </a>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block script %}
<script src="{{ blogBase.homeUrl }}/pagefind/pagefind-ui.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ 
            element: "#search",
            showSubResults: true,
            // [关键修复] 在 translations 对象外层添加 {% raw %} 和 {% endraw %}
            // 这样 Jinja2 就不会把 {{count}} 和 {{query}} 当作变量处理
            translations: {% raw %}{
                placeholder: "搜索本站所有内容...",
                search_label: "搜索",
                clear_search_label: "清除",
                load_more: "加载更多",
                search_results: "{{count}} 个结果",
                results_for: "\"{{query}}\" 的搜索结果",
                no_results_found: "没有找到与 \"{{query}}\" 相关的内容"
            }{% endraw %}
        });
    });
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
</script>
{% endblock %}
